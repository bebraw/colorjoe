/*! colorjoe - v0.5.0-wip - 2012-07-07
* http://bebraw.github.com/colorjoe/
* Copyright (c) 2012 Juho Vepsäläinen; Licensed MIT */
(function(a,b){typeof define=="function"&&define.amd?define(b):a.drag=b()})(this,function(){function a(a,d){if(!a){console.warn("drag is missing elem!");return}b()?c(a,d,"touchstart","touchmove","touchend"):c(a,d,"mousedown","mousemove","mouseup")}function b(){return typeof window.ontouchstart!="undefined"}function c(a,b,c,g,h){var k=!1;b=f(b);var l=b.begin,m=b.change,n=b.end;d(a,c,function(b){function f(){k=!1,e(document,g,c),e(document,h,f),i(n,a,b)}k=!0;var c=j(i,m,a);d(document,g,c),d(document,h,f),i(l,a,b)}),d(a,h,function(b){k=!1,i(n,a,b)})}function d(a,b,c){a.addEventListener(b,c,!1)}function e(a,b,c){a.removeEventListener(b,c,!1)}function f(a){if(!a){var b,c;return{begin:function(a){b={x:a.elem.offsetLeft,y:a.elem.offsetTop},c=a.cursor},change:function(a){g(a.elem,"left",b.x+a.cursor.x-c.x+"px"),g(a.elem,"top",b.y+a.cursor.y-c.y+"px")},end:h}}return{begin:a.begin||h,change:a.change||h,end:a.end||h}}function g(a,b,c){a.style[b]=c}function h(){}function i(a,b,c){c.preventDefault();var d=k(b),e=b.clientWidth,f=b.clientHeight,g={x:l(b,c),y:m(b,c)},h=(g.x-d.x)/e,i=(g.y-d.y)/f;a({x:isNaN(h)?0:h,y:isNaN(i)?0:i,cursor:g,elem:b,e:c})}function j(a){var b=Array.prototype.slice,c=b.apply(arguments,[1]);return function(){return a.apply(null,c.concat(b.apply(arguments)))}}function k(a){var b=0,c=0;if(a.offsetParent)do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent);return{x:b,y:c}}function l(a,b){if(n(a)){var c=parseInt(document.defaultView.getComputedStyle(document.body,"").marginLeft,10);return b.clientX-c}if(b.pageX)return b.pageX;if(b.clientX)return b.clientX+document.body.scrollLeft}function m(a,b){if(n(a)){var c=parseInt(document.defaultView.getComputedStyle(document.body,"").marginTop,10);return b.clientY-c}if(b.pageY)return b.pageY;if(b.clientY)return b.clientY+document.body.scrollTop}function n(a){while(a.nodeName!="HTML"&&o(a,"position")!="fixed")a=a.parentNode;return a.nodeName=="HTML"?!1:!0}function o(a,b){var c;return window.getComputedStyle?c=window.getComputedStyle(a,null):c=a.currentStyle,c[b]}return a}),function(a,b){typeof exports=="object"?module.exports=b():typeof define=="function"&&define.amd?define(b):a.colorutils=b()}(this,function(){var a=function(a,b){b(a)},b=function(a){return Object.prototype.toString.call(a)==="[object Array]"},c=function(a){return Object.prototype.toString.call(a)==="[object Object]"},d=function(a){return typeof a=="string"},e=function(a){return typeof a!="undefined"},f=function(a,b){var c="",d=!0;return g(function(a){d?a!=b&&(d=!1,c+=a):c+=a},a),c},g=function(a,e){if(b(e)||d(e))for(var f=0,g=e.length;f<g;f++)a(e[f],f);if(c(e)){var h=0;for(var i in e)a(i,e[i],h),h++}},h=function(a,d){var e;if(b(d)){e=[];for(var f=0,g=d.length;f<g;f++)e.push(a(d[f],f))}if(c(d)){e={};var h=0;for(var i in d){var j=d[i];e[i]=a(i,j,h),h++}}return e},i=function(a,b){var d;if(c(b)){d={};var e=0;for(var f in b){var g=b[f];a(f,g,e)&&(d[f]=g),e++}}return d},j=function(a,b){var c={},d=function(a,b){c[a]=b};return g(d,a),g(d,b),c},k=function(a){var b={};return g(function(a){b[a[0]]=a[1]},a),b},l=function(a,b){var c=[];for(var d=0;d<a.length;d++)c.push([a[d],b[d]]);return c},m=function(a){var b=[];return g(function(a){b.push(a)},a),b},n=function(a){var b=[];return g(function(a,c){b.push(c)},a),b},o=function(a,b,c){return Math.min(Math.max(a,b),c)},p=function(a,b,c){return b-=a.toString().length,b>0?(new Array(b+(/\./.test(a)?2:1))).join(c)+a:a};return{context:a,isArray:b,isObject:c,isString:d,isDefined:e,lstrip:f,each:g,map:h,filter:i,extend:j,toObject:k,zip:l,keys:m,values:n,clamp:o,leftFill:p}}),function(a,b){typeof exports=="object"?module.exports=b(require("./colorutils")):typeof define=="function"&&define.amd?define(["colorutils"],b):a.color=b(a.colorutils)}(this,function(a){var b=function(a){var b={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};return a in b?b[a]:undefined},c=function(b){return b=a.lstrip(b,"#"),{r:parseInt(b.substring(0,2),16)/255||0,g:parseInt(b.substring(2,4),16)/255||0,b:parseInt(b.substring(4,6),16)/255||0}},d=function(a){return i(c(a))},e=function(a){return j(c(a))},f=function(a){var b,c,d,e=a.s,f=a.v,g=a.h;if(e>0){g>=1&&(g=0),g=6*g,F=g-Math.floor(g),A=f*(1-e),c=f*(1-e*F),C=f*(1-e*(1-F));switch(Math.floor(g)){case 0:b=f,d=C,c=A;break;case 1:b=c,d=f,c=A;break;case 2:b=A,d=f,c=C;break;case 3:b=A,d=c,c=f;break;case 4:b=C,d=A,c=f;break;case 5:b=f,d=A,c=c}return{r:b?b:0,g:d?d:0,b:c?c:0}}return{r:f,g:f,b:f}},g=function(a,b,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?a+(b-a)*6*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a},h=function(a){var b,c,d,e=a.h,f=a.s,h=a.l;if(f===0)b=c=d=h;else{var i=h<.5?h*(1+f):h+f-h*f,j=2*h-i;b=g(j,i,e+1/3),c=g(j,i,e),d=g(j,i,e-1/3)}return{r:b,g:c,b:d}},i=function(a){var b=a.r,c=a.g,d=a.b,e=Math.max(b,c,d),f=Math.min(b,c,d),g,h,i=e,j=e-f;h=e===0?0:j/e;if(e==f)g=0;else{switch(e){case b:g=(c-d)/j+(c<d?6:0);break;case c:g=(d-b)/j+2;break;case d:g=(b-c)/j+4}g/=6}return{h:g,s:h,v:i}},j=function(a){var b=a.r,c=a.g,d=a.b,e=Math.max(b,c,d),f=Math.min(b,c,d),g,h,i=(e+f)/2;if(e==f)g=h=0;else{var j=e-f;h=i>.5?j/(2-e-f):j/(e+f);switch(e){case b:g=(c-d)/j+(c<d?6:0);break;case c:g=(d-b)/j+2;break;case d:g=(b-c)/j+4}g/=6}return{h:g,s:h,l:i}},k=function(b){function c(b){return a.leftFill(Math.round(b*255).toString(16),2,0)}return c(b.r)+c(b.g)+c(b.b)},l=function(a){return k(f(a))},m=function(a){return k(h(a))},n=function(c,d){var e=function(e){if(a.isString(e)){var f=b(e);return f||(f=e),d.hexToColor(f)}if(a.isObject(e)){if("toHex"in e){var g=d.hexToColor(e.toHex());return g.a=e.a(),g}return a.filter(function(a){return a in c},e)}return null};return function(b){var f=a.extend(c,e(b));f=a.map(function(b,c){return a.clamp(c,0,1)},f);var g=function(b){return function(c){return a.isDefined(c)?(f[b]=a.clamp(c,0,1),h):f[b]}},h={toArray:function(){return a.values(f)},toCSS:function(){var a=d.colorToRGB(f),b=parseInt(a.r*255,10),c=parseInt(a.g*255,10),e=parseInt(a.b*255,10),g=f.a;return f.a<1?"rgba("+b+","+c+","+e+","+g+")":"rgb("+b+","+c+","+e+")"},toRGBA:function(){var a=d.colorToRGB(f);return a.a=f.a,a},toHex:function(){return d.colorToHex(f)}};return a.each(function(a){h[a]=g(a)},a.keys(f)),h}},o=n({r:0,g:0,b:0,a:1},{hexToColor:c,colorToRGB:function(a){return a},colorToHex:k}),p=n({h:0,s:0,v:0,a:1},{hexToColor:d,colorToRGB:f,colorToHex:l}),q=n({h:0,s:0,l:0,a:1},{hexToColor:e,colorToRGB:h,colorToHex:m});return{nameToHex:b,rgba:o,hsva:p,hsla:q}}),function(a,b){typeof exports=="object"?module.exports=b():typeof define=="function"&&define.amd?define(b):a.elemutils=b()}(this,function(){function b(a,b,c){var d=document.createElement(a);return d.className=b,c.appendChild(d),d}function c(a){var b=Array.prototype.slice,c=b.apply(arguments,[1]);return function(){return a.apply(null,c.concat(b.apply(arguments)))}}function d(b,c,d,g){var h=a(b,d),i=e(c,h),j=f("text",h,g);return{label:i,input:j}}function e(a,c){var d=b("label","",c);return d.innerHTML=a,d}function f(a,c,d){var e=b("input","",c);return e.type=a,d&&(e.maxLength=d),e}var a=c(b,"div");return{e:b,div:a,partial:c,labelInput:d}}),function(a,b){typeof define=="function"&&define.amd?define(["./color","./drag","./elemutils"],b):a.colorjoe=b(a.color,a.drag,a.elemutils)}(this,function(a,b,c){function e(a){var b=c.div("currentColor",a);return{change:function(a){k(b,a.toCSS())}}}function f(b,d,e,f){f=f||255;var g=b+d+e;return g[g.length-1]!="a"&&(g+="a"),function(h,i){function l(){var b={};k.forEach(function(a){var c=a.label.innerHTML.toLowerCase();b[c]=a.input.value/f}),i.set(a[g](b))}var j=c.div("colorFields",h),k=[b,d,e].map(function(a){var b=c.labelInput("color "+a,a.toUpperCase(),j,3);return b.input.onkeyup=l,b});return{change:function(b){var c=a[g](b);k.forEach(function(a){var b=a.label.innerHTML.toLowerCase();a.input.value=Math.round(c[b]()*f)})}}}}function g(a,b){var d=c.labelInput("hex","",a,6);return d.input.onkeyup=function(a){b.set(a.target.value)},{change:function(a){d.input.value=a.toHex()}}}function h(b,c){k(b,a.hsva({h:c,s:1,v:1}).toCSS())}function i(a,b){a.style.left=q(b*100,0,100)+"%"}function j(a,b){a.style.top=q(b*100,0,100)+"%"}function k(a,b){a.style.background=b}function l(b){function f(a){i=d.xy(i,a,e,g),k()}function h(a){i=d.z(i,a.y,e,g),k()}function k(){for(var a=0,b=j.change.length;a<b;a++)j.change[a](i)}function l(){for(var a=0,b=j.done.length;a<b;a++)j.done[a](i)}if(!b.e)return console.warn("colorjoe: missing element");var c=r(b.e)?document.getElementById(b.e):b.e;c.className="colorPicker";var d=b.cbs,e=n({parent:c,"class":"twod",cbs:{begin:f,change:f,end:l}}),g=o({parent:c,"class":"oned",cbs:{begin:h,change:h,end:l}}),i=d.init(b.color,e,g),j={change:[],done:[]},p={e:c,update:function(){return k(),p},get:function(){return a.rgba(i)},set:function(a){var b=this.get();return i=d.init(a,e,g),b.toHex()!=i.toHex()&&k(),p},on:function(a,b){return a=="change"||a=="done"?j[a].push(b):console.warn('Passed invalid evt name "'+a+'" to colorjoe.on'),p},removeAllListeners:function(a){if(a)delete j[a];else for(var b in j)delete j[b]}};return m(c,p,b.extras),k(),p}function m(a,b,d){if(!d)return;var e=c.div("extras",a),f;d.forEach(function(a){f=a(e,b);for(var c in f)b.on(c,f[c])})}function n(a){var d=c.div,e=d(a["class"],a.parent),f=d("pointer",e);return d("shape shape1",f),d("shape shape2",f),d("bg bg1",e),d("bg bg2",e),b(e,a.cbs),{background:e,pointer:f}}function o(a){var d=c.div,e=d(a["class"],a.parent),f=d("pointer",e);return d("shape",f),d("bg",e),b(e,a.cbs),{background:e,pointer:f}}function p(a,b){return b.map(a).filter(t).length==b.length}function q(a,b,c){return Math.min(Math.max(a,b),c)}function r(a){return typeof a=="string"}function s(a){return typeof a=="function"}function t(a){return a}var d=function(a){return p(s,[a.init,a.xy,a.z])?function(b,c,d){l({e:b,color:c,cbs:a,extras:d})}:console.warn("colorjoe: missing cb")};return d.rgb=d({init:function(b,c,d){var e=a.hsva(b);return this.xy(e,{x:e.s(),y:1-e.v()},c,d),this.z(e,e.h(),c,d),e},xy:function(a,b,c,d){return i(c.pointer,b.x),j(c.pointer,b.y),a.s(b.x).v(1-b.y)},z:function(a,b,c,d){return j(d.pointer,b),h(c.background,b),a.h(b)}}),d.hsl=d({init:function(b,c,d){var e=a.hsla(b);return this.xy(e,{x:e.h(),y:1-e.s()},c,d),this.z(e,1-e.l(),c,d),e},xy:function(a,b,c,d){return i(c.pointer,b.x),j(c.pointer,b.y),h(d.background,b.x),a.h(b.x).s(1-b.y)},z:function(a,b,c,d){return j(d.pointer,b),a.l(1-b)}}),d.extras={currentColor:e,fields:f,hex:g},d});